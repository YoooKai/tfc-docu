
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://tu-usuario.github.io/tu-repo/dsw/">
      
      
        <link rel="prev" href="..">
      
      
        <link rel="next" href="../eie/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>DSW - Mi Documentación</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="deep-orange" data-md-color-accent="amber">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#dsw" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Mi Documentación" class="md-header__button md-logo" aria-label="Mi Documentación" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Mi Documentación
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              DSW
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="deep-orange" data-md-color-accent="amber"  aria-label="Cambiar a modo claro"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Cambiar a modo claro" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="deep-orange" data-md-color-accent="amber"  aria-label="Cambiar a modo oscuro"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Cambiar a modo oscuro" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/tu-usuario/tu-repo/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
  
    
  
  Inicio

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    <li class="md-tabs__item md-tabs__item--active">
      <a href="./" class="md-tabs__link">
        
  
  
    
  
  DSW

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../eie/" class="md-tabs__link">
        
  
  
    
  
  EIE

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../docs/intro.md" class="md-tabs__link">
          
  
  
  Guía

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../acerca.md" class="md-tabs__link">
        
  
  
    
  
  Acerca

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Mi Documentación" class="md-nav__button md-logo" aria-label="Mi Documentación" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Mi Documentación
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/tu-usuario/tu-repo/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Inicio
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    DSW
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    DSW
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduccion" class="md-nav__link">
    <span class="md-ellipsis">
      Introducción:
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#librerias-usadas-en-el-backend" class="md-nav__link">
    <span class="md-ellipsis">
      Librerías usadas en el backend
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aplicaciones" class="md-nav__link">
    <span class="md-ellipsis">
      APLICACIONES
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#main" class="md-nav__link">
    <span class="md-ellipsis">
      MAIN
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../eie/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    EIE
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Guía
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Guía
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../docs/intro.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introducción
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../docs/dsw.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    DSW
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../docs/uso.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Uso
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../acerca.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Acerca
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="dsw">DSW<a class="headerlink" href="#dsw" title="Permanent link">&para;</a></h1>
<h3 id="introduccion"><strong>Introducción:</strong><a class="headerlink" href="#introduccion" title="Permanent link">&para;</a></h3>
<p>El backend del proyecto está desarrollado con <strong>Django</strong> y se encarga de gestionar la lógica de negocio y los datos esenciales de la aplicación: productos, usuarios, pedidos, publicaciones de blog, eventos, imágenes y más. Mediante <strong>Django REST Framework</strong>, se crean las APIs que comunican esta información con el frontend. Django facilita el desarrollo gracias a sus herramientas integradas como el sistema de administración, el manejo de usuarios y su conexión con bases de datos.</p>
<h3 id="librerias-usadas-en-el-backend">Librerías usadas en el backend<a class="headerlink" href="#librerias-usadas-en-el-backend" title="Permanent link">&para;</a></h3>
<p>El proyecto he experimentado y explorado posibilidades, descubriendo librerías nuevas que me ayudaron a aumentar la rapidez para en la creación de apis.</p>
<ul>
<li><strong>Django</strong> y <strong>DRF</strong> forman la base del backend y la API REST.</li>
<li><strong>djoser</strong> y <strong>simplejwt</strong> facilitan la autenticación de usuarios mediante tokens JWT.</li>
<li><strong>django-cors-headers</strong> permite la comunicación con el frontend en Vue configurando el acceso entre orígenes distintos.</li>
<li><strong>pillow</strong> gestiona la carga y edición de imágenes.</li>
<li><strong>stripe</strong> permite integrar pagos seguros en la web.</li>
<li><strong>cryptography</strong> y <strong>defusedxml</strong> refuerzan la seguridad del proyecto, protegiendo datos sensibles y evitando vulnerabilidades XML.</li>
<li><strong>Kubi</strong> - personalizar el panel de administración</li>
<li>También se incluyen bibliotecas como <strong>requests</strong>, <strong>oauthlib</strong>, o <strong>social-auth.</strong></li>
</ul>
<h3 id="aplicaciones"><strong>APLICACIONES</strong><a class="headerlink" href="#aplicaciones" title="Permanent link">&para;</a></h3>
<p>Este proyecto cuenta con varias aplicaciones. Main, Post, Event, order, personal, portfolio, product, order. A continuación hablaré resumidamente de cada una de ellas.</p>
<p>Cuenta con la carpeta media, donde se guardan todas las imágenes subidas al proyecto.</p>
<h2 id="main">MAIN<a class="headerlink" href="#main" title="Permanent link">&para;</a></h2>
<p>La app <code>main</code> centraliza la configuración general del proyecto, como rutas, bases de datos, correo y middlewares. Incluye la configuración de <strong>envío de correos mediante Gmail</strong> para facilitar la comunicación en el formulario de contacto, y define los <strong>endpoints principales bajo <code>/api/v1/</code></strong>, lo que permite escalar futuras versiones (como <code>v2</code>). También gestiona la carga de archivos multimedia y estática, y define las rutas que enlazan con otras apps como <code>post</code>, <code>product</code>, <code>order</code>, etc.</p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">django.conf</span><span class="w"> </span><span class="kn">import</span> <span class="n">settings</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">django.conf.urls.static</span><span class="w"> </span><span class="kn">import</span> <span class="n">static</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">django.contrib</span><span class="w"> </span><span class="kn">import</span> <span class="n">admin</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">django.urls</span><span class="w"> </span><span class="kn">import</span> <span class="n">path</span><span class="p">,</span> <span class="n">include</span>

<span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;admin/&#39;</span><span class="p">,</span> <span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">urls</span><span class="p">),</span>
    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;api/v1/&#39;</span><span class="p">,</span> <span class="n">include</span><span class="p">(</span><span class="s1">&#39;djoser.urls&#39;</span><span class="p">)),</span>
    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;api/v1/&#39;</span><span class="p">,</span> <span class="n">include</span><span class="p">(</span><span class="s1">&#39;djoser.urls.authtoken&#39;</span><span class="p">)),</span>
    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;api/v1/&#39;</span><span class="p">,</span> <span class="n">include</span><span class="p">(</span><span class="s1">&#39;post.urls&#39;</span><span class="p">)),</span>
    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;api/v1/&#39;</span><span class="p">,</span> <span class="n">include</span><span class="p">(</span><span class="s1">&#39;product.urls&#39;</span><span class="p">)),</span>
    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;api/v1/&#39;</span><span class="p">,</span> <span class="n">include</span><span class="p">(</span><span class="s1">&#39;order.urls&#39;</span><span class="p">)),</span>
    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;api/v1/&#39;</span><span class="p">,</span> <span class="n">include</span><span class="p">(</span><span class="s1">&#39;event.urls&#39;</span><span class="p">)),</span>
    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;api/v1/&#39;</span><span class="p">,</span> <span class="n">include</span><span class="p">(</span><span class="s1">&#39;portfolio.urls&#39;</span><span class="p">)),</span>
    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;api/v1/&#39;</span><span class="p">,</span> <span class="n">include</span><span class="p">(</span><span class="s1">&#39;personal.urls&#39;</span><span class="p">)),</span>
<span class="p">]</span> <span class="o">+</span> <span class="n">static</span><span class="p">(</span><span class="n">settings</span><span class="o">.</span><span class="n">MEDIA_URL</span><span class="p">,</span> <span class="n">document_root</span><span class="o">=</span><span class="n">settings</span><span class="o">.</span><span class="n">MEDIA_ROOT</span><span class="p">)</span>
</code></pre></div>

<p>Les he escrito el prefijo v1 para que no haya conflicto en caso de una nueva actualización de la api, a la que llamaría v2, ets…</p>
<p><strong>Djoser: path('api/v1/', include('djoser.urls')),</strong></p>
<p>Incluye las URLs estándar de Djoser para manejar autenticación (registro, login, logout, cambio de contraseña, etc).</p>
<p><strong>path('api/v1/', include('djoser.urls.authtoken')),</strong></p>
<p>Incluye rutas específicas para el <strong>token de autenticación</strong> cuando usas el sistema de tokens con Django REST Framework.</p>
<h1 id="aplicacion-post">Aplicación <strong>Post</strong><a class="headerlink" href="#aplicacion-post" title="Permanent link">&para;</a></h1>
<p>Esta aplicación gestiona publicaciones o entradas de blog, permitiendo almacenar contenido textual junto con imágenes relacionadas, organizadas en categorías definidas.</p>
<hr />
<h3 id="modelo-post">Modelo <code>Post</code><a class="headerlink" href="#modelo-post" title="Permanent link">&para;</a></h3>
<p>Representa una entrada o publicación en el blog. Incluye los siguientes campos:</p>
<ul>
<li><code>title</code>: Título del post, máximo 256 caracteres.</li>
<li><code>slug</code>: Cadena única generada automáticamente a partir del título para URLs amigables.</li>
<li><code>content</code>: Contenido principal del post (texto libre).</li>
<li><code>created_at</code>: Fecha y hora de creación, asignada automáticamente.</li>
<li><code>category</code>: Categoría del post, con opciones predefinidas (<code>Artist Alley</code>, <code>Daily Life</code>, <code>Announcement</code>, etc.).</li>
</ul>
<p>El método <code>save()</code> sobreescrito asegura que el campo <code>slug</code> se actualice automáticamente usando la función <code>slugify</code> con base en el título, facilitando la generación de URLs limpias.</p>
<p>La clase <code>Meta</code> ordena los posts por fecha de creación descendente para mostrar primero los más recientes.</p>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Post</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="k">class</span><span class="w"> </span><span class="nc">Category</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">TextChoices</span><span class="p">):</span>
        <span class="n">ARTIST_ALLEY</span> <span class="o">=</span> <span class="s1">&#39;AL&#39;</span><span class="p">,</span> <span class="s1">&#39;Artist Alley&#39;</span>
        <span class="n">DAILY_LIFE</span> <span class="o">=</span> <span class="s1">&#39;DL&#39;</span><span class="p">,</span> <span class="s1">&#39;Daily Life&#39;</span>
        <span class="n">OTHER</span> <span class="o">=</span> <span class="s1">&#39;OT&#39;</span><span class="p">,</span> <span class="s1">&#39;Other&#39;</span>
        <span class="n">ANNOUNCEMENT</span> <span class="o">=</span> <span class="s1">&#39;AN&#39;</span><span class="p">,</span> <span class="s1">&#39;Announcement&#39;</span>

    <span class="n">title</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">256</span><span class="p">)</span>
    <span class="n">slug</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">SlugField</span><span class="p">(</span><span class="n">unique</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">content</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">TextField</span><span class="p">()</span>
    <span class="n">created_at</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateTimeField</span><span class="p">(</span><span class="n">auto_now_add</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">category</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="n">Category</span><span class="o">.</span><span class="n">choices</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">Category</span><span class="o">.</span><span class="n">OTHER</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">slug</span> <span class="o">=</span> <span class="n">slugify</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">title</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">title</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_absolute_url</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;/</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">slug</span><span class="si">}</span><span class="s1">/&#39;</span>

    <span class="k">class</span><span class="w"> </span><span class="nc">Meta</span><span class="p">:</span>
        <span class="n">ordering</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;-created_at&#39;</span><span class="p">]</span>
</code></pre></div>

<h3 id="modelo-postimage">Modelo <code>PostImage</code><a class="headerlink" href="#modelo-postimage" title="Permanent link">&para;</a></h3>
<p>Permite asociar múltiples imágenes a un post, con los siguientes campos:</p>
<ul>
<li><code>post</code>: Relación Many-to-One con el modelo <code>Post</code>.</li>
<li><code>image</code>: Archivo de imagen que se guarda en la carpeta <code>uploads/blog_posts/</code>.</li>
<li><code>caption</code>: Texto descriptivo o pie de foto, opcional.</li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">PostImage</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">post</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="n">Post</span><span class="p">,</span> <span class="n">on_delete</span><span class="o">=</span><span class="n">models</span><span class="o">.</span><span class="n">CASCADE</span><span class="p">,</span> <span class="n">related_name</span><span class="o">=</span><span class="s1">&#39;images&#39;</span><span class="p">)</span>
    <span class="n">image</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ImageField</span><span class="p">(</span><span class="n">upload_to</span><span class="o">=</span><span class="s1">&#39;uploads/blog_posts/&#39;</span><span class="p">)</span>
    <span class="n">caption</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Image for: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">post</span><span class="o">.</span><span class="n">title</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div>

<hr />
<h2 id="vistas">Vistas<a class="headerlink" href="#vistas" title="Permanent link">&para;</a></h2>
<p>Se utilizan vistas basadas en clases (APIView) para ofrecer acceso a las publicaciones a través de una API RESTful.</p>
<ul>
<li><strong><code>PostList</code></strong>: Devuelve una lista de posts, con opción a filtrar por categoría a través de un parámetro GET <code>category</code>.</li>
<li><strong><code>PostDetail</code></strong>: Devuelve los detalles completos de un post identificado por su <code>slug</code>.</li>
</ul>
<p>Ambas usan serializers para estructurar la respuesta JSON.</p>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">PostList</span><span class="p">(</span><span class="n">APIView</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">category</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">posts</span> <span class="o">=</span> <span class="n">Post</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">category</span><span class="p">:</span>
            <span class="n">posts</span> <span class="o">=</span> <span class="n">posts</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">category</span><span class="o">=</span><span class="n">category</span><span class="p">)</span>
        <span class="n">serializer</span> <span class="o">=</span> <span class="n">PostListSerializer</span><span class="p">(</span><span class="n">posts</span><span class="p">,</span> <span class="n">many</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Response</span><span class="p">(</span><span class="n">serializer</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

<span class="k">class</span><span class="w"> </span><span class="nc">PostDetail</span><span class="p">(</span><span class="n">APIView</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_object</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">slug</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Post</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">slug</span><span class="o">=</span><span class="n">slug</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">Post</span><span class="o">.</span><span class="n">DoesNotExist</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">Http404</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">slug</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">post</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_object</span><span class="p">(</span><span class="n">slug</span><span class="p">)</span>
        <span class="n">serializer</span> <span class="o">=</span> <span class="n">PostDetailSerializer</span><span class="p">(</span><span class="n">post</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Response</span><span class="p">(</span><span class="n">serializer</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="serializadores">Serializadores<a class="headerlink" href="#serializadores" title="Permanent link">&para;</a></h2>
<p>Transforman los modelos en datos JSON para la API.</p>
<ul>
<li><code>PostImageSerializer</code>: Serializa imágenes con su ruta y caption.</li>
<li><code>PostListSerializer</code>: Resume los posts con título, slug, fecha, categoría legible, resumen del contenido y lista de imágenes.</li>
<li><code>PostDetailSerializer</code>: Muestra todos los detalles del post, incluyendo contenido completo e imágenes.</li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">PostImageSerializer</span><span class="p">(</span><span class="n">serializers</span><span class="o">.</span><span class="n">ModelSerializer</span><span class="p">):</span>
    <span class="k">class</span><span class="w"> </span><span class="nc">Meta</span><span class="p">:</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">PostImage</span>
        <span class="n">fields</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;image&#39;</span><span class="p">,</span> <span class="s1">&#39;caption&#39;</span><span class="p">]</span>

<span class="k">class</span><span class="w"> </span><span class="nc">PostListSerializer</span><span class="p">(</span><span class="n">serializers</span><span class="o">.</span><span class="n">ModelSerializer</span><span class="p">):</span>
    <span class="n">summary</span> <span class="o">=</span> <span class="n">serializers</span><span class="o">.</span><span class="n">SerializerMethodField</span><span class="p">()</span>
    <span class="n">category_display</span> <span class="o">=</span> <span class="n">serializers</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="s1">&#39;get_category_display&#39;</span><span class="p">,</span> <span class="n">read_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">images</span> <span class="o">=</span> <span class="n">PostImageSerializer</span><span class="p">(</span><span class="n">many</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">read_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">class</span><span class="w"> </span><span class="nc">Meta</span><span class="p">:</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">Post</span>
        <span class="n">fields</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;slug&#39;</span><span class="p">,</span> <span class="s1">&#39;created_at&#39;</span><span class="p">,</span> <span class="s1">&#39;category&#39;</span><span class="p">,</span> <span class="s1">&#39;category_display&#39;</span><span class="p">,</span> <span class="s1">&#39;summary&#39;</span><span class="p">,</span> <span class="s1">&#39;images&#39;</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_summary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">split</span><span class="p">()[:</span><span class="mi">25</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;...&#39;</span>

<span class="k">class</span><span class="w"> </span><span class="nc">PostDetailSerializer</span><span class="p">(</span><span class="n">serializers</span><span class="o">.</span><span class="n">ModelSerializer</span><span class="p">):</span>
    <span class="n">images</span> <span class="o">=</span> <span class="n">PostImageSerializer</span><span class="p">(</span><span class="n">many</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">read_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">category_display</span> <span class="o">=</span> <span class="n">serializers</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="s1">&#39;get_category_display&#39;</span><span class="p">,</span> <span class="n">read_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">class</span><span class="w"> </span><span class="nc">Meta</span><span class="p">:</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">Post</span>
        <span class="n">fields</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;slug&#39;</span><span class="p">,</span> <span class="s1">&#39;content&#39;</span><span class="p">,</span> <span class="s1">&#39;created_at&#39;</span><span class="p">,</span> <span class="s1">&#39;category&#39;</span><span class="p">,</span> <span class="s1">&#39;category_display&#39;</span><span class="p">,</span> <span class="s1">&#39;images&#39;</span><span class="p">]</span>
</code></pre></div>

<hr />
<h2 id="tests">Tests<a class="headerlink" href="#tests" title="Permanent link">&para;</a></h2>
<p>Se valida el comportamiento de la API para obtener la lista de posts y el detalle de un post específico, incluyendo la gestión de errores para slugs no existentes.</p>
<ul>
<li>Se crea un post de prueba en <code>setUp</code>.</li>
<li>Se verifica que la lista de posts incluya dicho post.</li>
<li>Se consulta el detalle por slug y se confirma la respuesta.</li>
<li>Se prueba que un slug inexistente devuelve un error 404.</li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">PostAPITest</span><span class="p">(</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client</span> <span class="o">=</span> <span class="n">APIClient</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">post</span> <span class="o">=</span> <span class="n">Post</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
            <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Test Post&quot;</span><span class="p">,</span>
            <span class="n">content</span><span class="o">=</span><span class="s2">&quot;Contenido de prueba para el post.&quot;</span><span class="p">,</span>
            <span class="n">category</span><span class="o">=</span><span class="n">Post</span><span class="o">.</span><span class="n">Category</span><span class="o">.</span><span class="n">ANNOUNCEMENT</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">test_post_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;/api/v1/posts/&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="n">status</span><span class="o">.</span><span class="n">HTTP_200_OK</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">any</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Test Post&quot;</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">data</span><span class="p">))</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">test_post_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;/api/v1/posts/</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">post</span><span class="o">.</span><span class="n">slug</span><span class="si">}</span><span class="s1">/&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="n">status</span><span class="o">.</span><span class="n">HTTP_200_OK</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">],</span> <span class="s2">&quot;Test Post&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">test_post_not_found</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;/api/v1/posts/slug-inexistente/&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="n">status</span><span class="o">.</span><span class="n">HTTP_404_NOT_FOUND</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2 id="urls">URLs<a class="headerlink" href="#urls" title="Permanent link">&para;</a></h2>
<p>Se definen rutas RESTful para la API de posts:</p>
<div class="codehilite"><pre><span></span><code><span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;posts/&#39;</span><span class="p">,</span> <span class="n">PostList</span><span class="o">.</span><span class="n">as_view</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;post-list&#39;</span><span class="p">),</span>
    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;posts/&lt;slug:slug&gt;/&#39;</span><span class="p">,</span> <span class="n">PostDetail</span><span class="o">.</span><span class="n">as_view</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;post-detail&#39;</span><span class="p">),</span>
<span class="p">]</span>
</code></pre></div>

<hr />
<h2 id="aplicacion-event"><strong>Aplicación Event</strong><a class="headerlink" href="#aplicacion-event" title="Permanent link">&para;</a></h2>
<p>Esta aplicación contiene el modelo UpcomingEvent representa eventos próximos con detalles básicos para su presentación.</p>
<ul>
<li><strong>Campos principales:</strong><ul>
<li><code>title</code> (CharField): Título del evento.</li>
<li><code>image</code> (ImageField): Imagen asociada al evento, guardada en la carpeta <code>uploads/events/</code>.</li>
<li><code>start_date</code> (DateField): Fecha de inicio del evento.</li>
<li><code>end_date</code> (DateField, opcional): Fecha de finalización, permite eventos de varios días.</li>
<li><code>location</code> (CharField): Lugar donde se realizará el evento.</li>
<li><code>link</code> (URLField, opcional): Enlace externo relacionado con el evento (por ejemplo, página oficial).</li>
<li><code>location_link</code> (URLField, opcional): Enlace para la ubicación (como un mapa o dirección web).</li>
</ul>
</li>
<li><strong>Comportamiento:</strong><ul>
<li>Ordena los eventos automáticamente por fecha de inicio (<code>start_date</code>).</li>
<li>Método <code>is_multi_day()</code> que devuelve <code>True</code> si el evento dura más de un día.</li>
</ul>
</li>
<li><strong>Representación:</strong><ul>
<li>El método <code>__str__</code> retorna el título para facilitar su identificación en interfaces administrativas.</li>
</ul>
</li>
</ul>
<p>Tiene una vista basada en APIView que crea un endpoint para obtener la lista completa de eventos próximos. Al recibir una petición GET, consulta todos los registros del modelo <code>UpcomingEvent</code>, los serializa con <code>UpcomingEventSerializer</code> y devuelve los datos en formato JSON.</p>
<p>La url para esta es: </p>
<div class="codehilite"><pre><span></span><code><span class="n">path</span><span class="p">(</span><span class="s1">&#39;events/&#39;</span><span class="p">,</span> <span class="n">UpcomingEventList</span><span class="o">.</span><span class="n">as_view</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;upcoming-events&#39;</span><span class="p">),</span>
</code></pre></div>

<p>También tiene un test que crea un evento de prueba, hace una petición GET al endpoint <code>/events/, v</code>erifica que la respuesta es 200 OK y comprueba que el evento creado aparece en la respuesta.</p>
<h3 id="aplicacion-portfolio">Aplicación Portfolio<a class="headerlink" href="#aplicacion-portfolio" title="Permanent link">&para;</a></h3>
<p>Representa una entrada del portafolio.</p>
<p><strong>Modelo</strong> </p>
<ul>
<li><code>title</code> (CharField): Título de la entrada del portafolio, con un máximo de 255 caracteres.</li>
<li><code>image</code> (ImageField): Imagen asociada a la entrada, almacenada en la carpeta <code>uploads/portfolio/</code>.</li>
<li><code>category</code> (CharField): Categoría de la entrada, con opciones predefinidas: Concept Art, Animación, Ilustración, y Otros (por defecto).</li>
<li><code>created_at</code> (DateTimeField): Fecha y hora en que se creó la entrada, se asigna automáticamente al crear el registro.</li>
</ul>
<p>Las entradas se ordenan por fecha de creación descendente (<code>ordering = ['-created_at']</code>), mostrando primero las más recientes.</p>
<p>Como en el caso anterior, es una aplicación simple con una vista basada en APIView que obtiene una lista de registros que son serializados. Y una URL para acceder a los datos.</p>
<div class="codehilite"><pre><span></span><code><span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;portfolio/&#39;</span><span class="p">,</span> <span class="n">PortfolioEntryList</span><span class="o">.</span><span class="n">as_view</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;portfolio-list&#39;</span><span class="p">),</span>
<span class="p">]</span>
</code></pre></div>

<h3 id="aplicacion-personal">Aplicación <strong>Personal</strong><a class="headerlink" href="#aplicacion-personal" title="Permanent link">&para;</a></h3>
<p>Contiene modelos que gestionan la información personal, comisiones, preguntas frecuentes y contactos de la web.</p>
<h3 id="modelo-about">Modelo <strong>About</strong><a class="headerlink" href="#modelo-about" title="Permanent link">&para;</a></h3>
<ul>
<li><code>title</code> (CharField, opcional): Título descriptivo, puede quedar vacío.</li>
<li><code>content</code> (TextField): Texto con información sobre la persona o proyecto.</li>
<li><code>image</code> (ImageField, opcional): Imagen relacionada, almacenada en <code>media/about/</code>.</li>
</ul>
<p>Representa la sección “Acerca de mí” o información general.</p>
<hr />
<h3 id="modelo-commissions">Modelo <strong>Commissions</strong><a class="headerlink" href="#modelo-commissions" title="Permanent link">&para;</a></h3>
<ul>
<li><code>title</code> (CharField, opcional): Título del servicio o comisión ofrecida.</li>
<li><code>description</code> (TextField): Descripción detallada de la comisión.</li>
<li><code>price</code> (DecimalField): Precio de la comisión, con hasta 10 dígitos y 2 decimales.</li>
<li><code>slots_left</code> (PositiveIntegerField): Número de plazas disponibles para la comisión.</li>
<li><code>image</code> (ImageField, opcional): Imagen ilustrativa guardada en <code>media/comissions/</code>.</li>
</ul>
<p>Gestiona las ofertas y disponibilidad de comisiones personalizadas.</p>
<hr />
<h3 id="modelo-faq">Modelo <strong>FAQ</strong><a class="headerlink" href="#modelo-faq" title="Permanent link">&para;</a></h3>
<ul>
<li><code>question</code> (CharField): Pregunta frecuente.</li>
<li><code>answer</code> (TextField): Respuesta correspondiente a la pregunta.</li>
</ul>
<p>Modelo para mostrar las preguntas frecuentes y sus respuestas.</p>
<hr />
<h3 id="modelo-contact">Modelo <strong>Contact</strong><a class="headerlink" href="#modelo-contact" title="Permanent link">&para;</a></h3>
<ul>
<li><code>name</code> (CharField): Nombre del usuario que contacta.</li>
<li><code>email</code> (EmailField): Correo electrónico del usuario.</li>
<li><code>message</code> (TextField): Mensaje enviado por el usuario.</li>
<li><code>created_at</code> (DateTimeField): Fecha y hora en que se creó el contacto (registro automático).</li>
</ul>
<p>Permite registrar los mensajes y consultas recibidas desde la sección de contacto.</p>
<h3 id="vistas-apiview">Vistas (APIView)<a class="headerlink" href="#vistas-apiview" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p><strong>ContactView (POST)</strong></p>
<p>Recibe nombre, email y mensaje, valida campos, guarda contacto y envía email notificando el mensaje.</p>
</li>
<li>
<p><strong>AboutView (GET)</strong></p>
<p>Devuelve la primera instancia de About serializada.</p>
</li>
<li>
<p><strong>CommissionsList (GET)</strong></p>
<p>Devuelve la lista completa de comisiones serializadas.</p>
</li>
<li>
<p><strong>FAQList (GET)</strong></p>
<p>Devuelve todas las preguntas frecuentes serializadas.</p>
</li>
</ul>
<h3 id="serializadores_1">Serializadores<a class="headerlink" href="#serializadores_1" title="Permanent link">&para;</a></h3>
<p>Se basan en <code>ModelSerializer</code> y exponen todos los campos de sus modelos:</p>
<p><code>AboutSerializer, CommissionsSerializer, FAQSerializer</code></p>
<h3 id="formulario">Formulario<a class="headerlink" href="#formulario" title="Permanent link">&para;</a></h3>
<p><strong>ContactForm, un sencillo formulario para recibir mensajes desde el front.</strong></p>
<p>Campos: <code>name</code>, <code>email</code>, <code>message</code> con validación básica, usado para validar datos de contacto.</p>
<h3 id="urls_1">Urls<a class="headerlink" href="#urls_1" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code><span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;contact/&#39;</span><span class="p">,</span> <span class="n">ContactView</span><span class="o">.</span><span class="n">as_view</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;contact&#39;</span><span class="p">),</span>
    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;about/&#39;</span><span class="p">,</span> <span class="n">AboutView</span><span class="o">.</span><span class="n">as_view</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;about&#39;</span><span class="p">),</span>
    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;commissions/&#39;</span><span class="p">,</span> <span class="n">CommissionsList</span><span class="o">.</span><span class="n">as_view</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;commissions&#39;</span><span class="p">),</span>
    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;faq/&#39;</span><span class="p">,</span> <span class="n">FAQList</span><span class="o">.</span><span class="n">as_view</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;faq&#39;</span><span class="p">),</span>
<span class="p">]</span>
</code></pre></div>

<h3 id="tests_1"><strong>Tests</strong><a class="headerlink" href="#tests_1" title="Permanent link">&para;</a></h3>
<p>He añadido unos test de comprobación sencillos en esta app:</p>
<ul>
<li><strong>test_get_about</strong>: Verifica que la vista de "About" responde con éxito (200 OK) y que el contenido incluye el título esperado.</li>
<li><strong>test_get_commissions</strong>: Comprueba que la lista de comisiones se obtiene correctamente y que devuelve al menos un elemento.</li>
<li><strong>test_get_faq</strong>: Asegura que la lista de preguntas frecuentes (FAQ) se recupera correctamente y no está vacía.</li>
<li><strong>test_post_contact_success</strong>: Prueba que al enviar un mensaje de contacto válido, la API responde con éxito, guarda el mensaje en la base de datos y confirma el envío.</li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">test_post_contact_success</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">url</span> <span class="o">=</span> <span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;contact&#39;</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Sergio&#39;</span><span class="p">,</span>
            <span class="s1">&#39;email&#39;</span><span class="p">:</span> <span class="s1">&#39;matraca@example.com&#39;</span><span class="p">,</span>
            <span class="s1">&#39;message&#39;</span><span class="p">:</span> <span class="s1">&#39;Hola matraca, este es un mensaje de prueba.&#39;</span>
        <span class="p">}</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="n">status</span><span class="o">.</span><span class="n">HTTP_200_OK</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;message&#39;</span><span class="p">],</span> <span class="s1">&#39;¡Se ha enviado el mensaje con éxito!&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">Contact</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">email</span><span class="o">=</span><span class="s1">&#39;matraca@example.com&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">())</span>
</code></pre></div>

<ul>
<li><strong>test_post_contact_missing_fields</strong>: Verifica que si faltan datos obligatorios en el formulario de contacto, la API responde con un error 400 y muestra un mensaje de error.</li>
</ul>
<h2 id="aplicacion-product">Aplicación Product<a class="headerlink" href="#aplicacion-product" title="Permanent link">&para;</a></h2>
<h3 id="modelo-category">Modelo Category<a class="headerlink" href="#modelo-category" title="Permanent link">&para;</a></h3>
<p>Este modelo representa las categorías de productos en la tienda. Cada categoría tiene un nombre (<code>name</code>) y un <code>slug</code> único que se utiliza para construir URLs amigables. Las categorías se ordenan alfabéticamente por nombre para facilitar su visualización.</p>
<ul>
<li><strong>Campos:</strong><ul>
<li><code>name</code>: Nombre descriptivo de la categoría.</li>
<li><code>slug</code>: Identificador único para URLs.</li>
</ul>
</li>
<li><strong>Métodos importantes:</strong><ul>
<li><code>get_absolute_url()</code>: Devuelve la URL relativa basada en el slug, facilitando la navegación hacia la categoría.</li>
</ul>
</li>
<li><strong>Meta:</strong><ul>
<li>Ordena las categorías por nombre (<code>ordering = ('name',)</code>).</li>
</ul>
</li>
</ul>
<hr />
<h3 id="modelo-product">Modelo Product<a class="headerlink" href="#modelo-product" title="Permanent link">&para;</a></h3>
<p>Este modelo define los productos que se ofrecen en la tienda, cada uno vinculado a una categoría específica mediante una relación de clave foránea (<code>ForeignKey</code>). Incluye detalles básicos como nombre, descripción, precio y fechas de creación. También permite gestionar imágenes principales y miniaturas, generando automáticamente una miniatura si no existe para optimizar la carga.</p>
<ul>
<li><strong>Campos principales:</strong><ul>
<li><code>category</code>: Categoría a la que pertenece el producto.</li>
<li><code>name</code>: Nombre del producto.</li>
<li><code>slug</code>: Identificador único para URLs.</li>
<li><code>description</code>: Descripción detallada (opcional).</li>
<li><code>price</code>: Precio del producto con dos decimales.</li>
<li><code>image</code>: Imagen principal del producto.</li>
<li><code>thumbnail</code>: Imagen en miniatura, optimizada para cargas rápidas.</li>
<li><code>date_added</code>: Fecha en que se añadió el producto.</li>
<li><code>weight</code>: Peso base del producto en gramos (importante para envíos y logística).</li>
</ul>
</li>
<li><strong>Métodos relevantes:</strong><ul>
<li><code>get_absolute_url()</code>: Construye la URL del producto usando el slug de la categoría y del producto.</li>
<li><code>get_image()</code>: Retorna la URL completa de la imagen principal.</li>
<li><code>get_thumbnail()</code>: Retorna la URL de la miniatura, generándola automáticamente si no existe.</li>
<li><code>make_thumbnail(image, size)</code>: Crea una miniatura redimensionando y optimizando la imagen principal.</li>
</ul>
</li>
<li><strong>Meta:</strong><ul>
<li>Ordena los productos por fecha de adición, mostrando primero los más recientes (<code>ordering = ('-date_added',)</code>).</li>
</ul>
</li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Product</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">category</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="n">Category</span><span class="p">,</span> <span class="n">related_name</span><span class="o">=</span><span class="s1">&#39;products&#39;</span><span class="p">,</span> <span class="n">on_delete</span><span class="o">=</span><span class="n">models</span><span class="o">.</span><span class="n">CASCADE</span><span class="p">)</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">255</span><span class="p">)</span>
    <span class="n">slug</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">SlugField</span><span class="p">(</span><span class="n">unique</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">description</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">TextField</span><span class="p">(</span><span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">price</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DecimalField</span><span class="p">(</span><span class="n">max_digits</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">decimal_places</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">image</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ImageField</span><span class="p">(</span><span class="n">upload_to</span><span class="o">=</span><span class="s1">&#39;uploads/&#39;</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">thumbnail</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ImageField</span><span class="p">(</span><span class="n">upload_to</span><span class="o">=</span><span class="s1">&#39;uploads/&#39;</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">date_added</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateTimeField</span><span class="p">(</span><span class="n">auto_now_add</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">weight</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">PositiveIntegerField</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">help_text</span><span class="o">=</span><span class="s2">&quot;Peso base en gramos&quot;</span><span class="p">)</span>

    <span class="k">class</span><span class="w"> </span><span class="nc">Meta</span><span class="p">:</span>
        <span class="n">ordering</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;-date_added&#39;</span><span class="p">,)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_absolute_url</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;/</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">category</span><span class="o">.</span><span class="n">slug</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">slug</span><span class="si">}</span><span class="s1">/&#39;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_image</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;http://127.0.0.1:8000&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">url</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_thumbnail</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">thumbnail</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;http://127.0.0.1:8000&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">thumbnail</span><span class="o">.</span><span class="n">url</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">thumbnail</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_thumbnail</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
                <span class="k">return</span> <span class="s1">&#39;http://127.0.0.1:8000&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">thumbnail</span><span class="o">.</span><span class="n">url</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="s1">&#39;&#39;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">make_thumbnail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">600</span><span class="p">,</span> <span class="mi">400</span><span class="p">)):</span>

        <span class="n">img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
        <span class="n">img</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="s1">&#39;RGB&#39;</span><span class="p">)</span>
        <span class="n">img</span><span class="o">.</span><span class="n">thumbnail</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>

        <span class="n">thumb_io</span> <span class="o">=</span> <span class="n">BytesIO</span><span class="p">()</span>
        <span class="n">img</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">thumb_io</span><span class="p">,</span> <span class="s1">&#39;JPEG&#39;</span><span class="p">,</span> <span class="n">quality</span><span class="o">=</span><span class="mi">85</span><span class="p">)</span>

        <span class="n">thumbnail</span> <span class="o">=</span> <span class="n">File</span><span class="p">(</span><span class="n">thumb_io</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">thumbnail</span>
</code></pre></div>

<hr />
<h3 id="modelo-productimage">Modelo ProductImage<a class="headerlink" href="#modelo-productimage" title="Permanent link">&para;</a></h3>
<p>Este modelo permite añadir múltiples imágenes adicionales para un producto, mejorando la presentación visual en la tienda.</p>
<ul>
<li><strong>Campos:</strong><ul>
<li><code>product</code>: Producto asociado (FK).</li>
<li><code>image</code>: Imagen adicional.</li>
<li><code>alt_text</code>: Texto alternativo para accesibilidad y SEO (opcional).</li>
</ul>
</li>
</ul>
<hr />
<h3 id="modelo-productoption">Modelo ProductOption<a class="headerlink" href="#modelo-productoption" title="Permanent link">&para;</a></h3>
<p>Define opciones o variantes de un producto que pueden afectar su precio y peso, como diferentes tamaños, colores o configuraciones personalizadas.</p>
<ul>
<li><strong>Campos:</strong><ul>
<li><code>product</code>: Producto asociado (FK).</li>
<li><code>name</code>: Nombre de la opción o variante.</li>
<li><code>additional_price</code>: Precio adicional que suma esta opción al producto base.</li>
<li><code>additional_weight</code>: Incremento o decremento de peso en gramos que añade esta opción.</li>
</ul>
</li>
</ul>
<p>Este conjunto de modelos está diseñado para gestionar la tienda en línea con productos categorizados, número de imágenes flexible y variantes personalizables, proporcionando una base robusta para manejar catálogo, presentación y cálculo de precios/pesos para envíos. Además, incluye funciones para optimizar la carga de imágenes con miniaturas generadas automáticamente.</p>
<h3 id="vistas-del-modulo-de-productos">Vistas del módulo de productos<a class="headerlink" href="#vistas-del-modulo-de-productos" title="Permanent link">&para;</a></h3>
<hr />
<h3 id="latestproductslist-apiview"><code>LatestProductsList</code> (APIView)<a class="headerlink" href="#latestproductslist-apiview" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p><strong>Descripción:</strong></p>
<p>Proporciona una lista completa de todos los productos disponibles en la tienda.</p>
</li>
<li>
<p><strong>Métodos:</strong></p>
<ul>
<li><code>get</code>: Recupera todos los objetos <code>Product</code>, los serializa y devuelve los datos en formato JSON.</li>
</ul>
</li>
<li>
<p><strong>Uso:</strong></p>
<p>Endpoint para mostrar todos los productos recientes o disponibles.</p>
</li>
</ul>
<hr />
<h3 id="productdetail-apiview"><code>ProductDetail</code> (APIView)<a class="headerlink" href="#productdetail-apiview" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p><strong>Descripción:</strong></p>
<p>Muestra el detalle de un producto específico, identificándolo por el slug de la categoría y el slug del producto.</p>
</li>
<li>
<p><strong>Métodos:</strong></p>
<ul>
<li><code>get_object(category_slug, product_slug)</code>: Busca el producto que corresponde a la categoría y slug indicados. Si no existe, lanza un error 404.</li>
<li><code>get</code>: Usa <code>get_object</code> para obtener el producto y devuelve su información serializada.</li>
</ul>
</li>
<li>
<p><strong>Uso:</strong></p>
<p>Endpoint para obtener la información completa de un producto en particular.</p>
</li>
</ul>
<hr />
<h3 id="categorydetail-apiview"><code>CategoryDetail</code> (APIView)<a class="headerlink" href="#categorydetail-apiview" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p><strong>Descripción:</strong></p>
<p>Proporciona la información detallada de una categoría identificada por su slug.</p>
</li>
<li>
<p><strong>Métodos:</strong></p>
<ul>
<li><code>get_object(category_slug)</code>: Busca la categoría por slug o lanza error 404 si no existe.</li>
<li><code>get</code>: Devuelve los datos serializados de la categoría encontrada.</li>
</ul>
</li>
<li>
<p><strong>Uso:</strong></p>
<p>Endpoint para ver detalles de una categoría específica.</p>
</li>
</ul>
<hr />
<h3 id="search-funcion-con-decorador-api_viewpost"><code>search</code> (Función con decorador <code>@api_view(['POST'])</code>)<a class="headerlink" href="#search-funcion-con-decorador-api_viewpost" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p><strong>Descripción:</strong></p>
<p>Permite buscar productos mediante una consulta de texto, que compara el término con los campos <code>name</code> y <code>description</code>.</p>
</li>
<li>
<p><strong>Parámetros:</strong></p>
<ul>
<li>Recibe un JSON con el campo <code>query</code> que contiene la palabra o frase a buscar.</li>
</ul>
</li>
<li><strong>Funcionamiento:</strong><ul>
<li>Filtra los productos que contengan el texto buscado en su nombre o descripción (case-insensitive).</li>
<li>Devuelve la lista de productos que coinciden, o una lista vacía si no hay término de búsqueda.</li>
</ul>
</li>
<li>
<p><strong>Uso:</strong></p>
<p>Endpoint para implementar funcionalidades de búsqueda dinámica en la tienda.</p>
</li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="nd">@api_view</span><span class="p">([</span><span class="s1">&#39;POST&#39;</span><span class="p">])</span>
<span class="k">def</span><span class="w">  </span><span class="nf">search</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="n">query</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;query&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">query</span><span class="p">:</span>
        <span class="n">products</span> <span class="o">=</span> <span class="n">Product</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">Q</span><span class="p">(</span><span class="n">name__icontains</span><span class="o">=</span><span class="n">query</span><span class="p">)</span> <span class="o">|</span> <span class="n">Q</span><span class="p">(</span><span class="n">description__icontains</span><span class="o">=</span><span class="n">query</span><span class="p">))</span>
        <span class="n">serializer</span> <span class="o">=</span> <span class="n">ProductSerializer</span><span class="p">(</span><span class="n">products</span><span class="p">,</span> <span class="n">many</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Response</span><span class="p">(</span><span class="n">serializer</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Response</span><span class="p">({</span><span class="s1">&#39;products&#39;</span><span class="p">:</span> <span class="p">[]})</span>
</code></pre></div>

<h3 id="serializadores-del-modulo-de-productos">Serializadores del módulo de productos<a class="headerlink" href="#serializadores-del-modulo-de-productos" title="Permanent link">&para;</a></h3>
<hr />
<h3 id="productimageserializer"><code>ProductImageSerializer</code><a class="headerlink" href="#productimageserializer" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p><strong>Descripción:</strong></p>
<p>Serializa las imágenes asociadas a un producto.</p>
</li>
<li>
<p><strong>Campos:</strong></p>
<ul>
<li><code>image</code>: archivo de imagen.</li>
<li><code>alt_text</code>: texto alternativo para accesibilidad.</li>
<li><code>full_image_url</code>: URL completa absoluta generada dinámicamente para acceder a la imagen.</li>
</ul>
</li>
<li><strong>Métodos especiales:</strong><ul>
<li><code>get_full_image_url</code>: Construye la URL completa de la imagen usando el contexto de la petición para devolver un enlace absoluto.</li>
</ul>
</li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ProductImageSerializer</span><span class="p">(</span><span class="n">serializers</span><span class="o">.</span><span class="n">ModelSerializer</span><span class="p">):</span>
    <span class="n">full_image_url</span> <span class="o">=</span> <span class="n">serializers</span><span class="o">.</span><span class="n">SerializerMethodField</span><span class="p">()</span>

    <span class="k">class</span><span class="w"> </span><span class="nc">Meta</span><span class="p">:</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">ProductImage</span>
        <span class="n">fields</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;image&#39;</span><span class="p">,</span> <span class="s1">&#39;alt_text&#39;</span><span class="p">,</span> <span class="s1">&#39;full_image_url&#39;</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_full_image_url</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="n">request</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;request&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">request</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">request</span><span class="o">.</span><span class="n">build_absolute_uri</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">url</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">url</span>
</code></pre></div>

<hr />
<h3 id="productoptionserializer"><code>ProductOptionSerializer</code><a class="headerlink" href="#productoptionserializer" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p><strong>Descripción:</strong></p>
<p>Serializa las opciones adicionales de un producto, como variantes con precio y peso extra.</p>
</li>
<li>
<p><strong>Campos:</strong></p>
<ul>
<li><code>name</code>: nombre de la opción.</li>
<li><code>additional_price</code>: incremento en el precio para esta opción.</li>
<li><code>additional_weight</code>: incremento en el peso para esta opción.</li>
</ul>
</li>
</ul>
<hr />
<h3 id="productserializer"><code>ProductSerializer</code><a class="headerlink" href="#productserializer" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p><strong>Descripción:</strong></p>
<p>Serializa un producto, incluyendo sus datos básicos, imágenes y opciones relacionadas.</p>
</li>
<li>
<p><strong>Campos:</strong></p>
<ul>
<li><code>id</code>, <code>name</code>, <code>price</code>, <code>weight</code>: información básica del producto.</li>
<li><code>get_absolute_url</code>: URL relativa al detalle del producto.</li>
<li><code>description</code>: descripción del producto.</li>
<li><code>get_image</code>, <code>get_thumbnail</code>: métodos que devuelven las URLs de imagen principal y miniatura.</li>
<li><code>images</code>: lista de imágenes adicionales, serializadas con <code>ProductImageSerializer</code>.</li>
<li><code>options</code>: lista de opciones del producto, serializadas con <code>ProductOptionSerializer</code>.</li>
</ul>
</li>
</ul>
<hr />
<h3 id="categoryserializer"><code>CategorySerializer</code><a class="headerlink" href="#categoryserializer" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p><strong>Descripción:</strong></p>
<p>Serializa una categoría, incluyendo la lista de productos que pertenecen a ella.</p>
</li>
<li>
<p><strong>Campos:</strong></p>
<ul>
<li><code>id</code>, <code>name</code>: datos básicos de la categoría.</li>
<li><code>get_absolute_url</code>: URL relativa para acceder a la categoría.</li>
<li><code>products</code>: lista de productos relacionados, serializados con <code>ProductSerializer</code>.</li>
</ul>
</li>
</ul>
<h3 id="urls-de-la-aplicacion-product">URLs de la aplicación Product<a class="headerlink" href="#urls-de-la-aplicacion-product" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">django.urls</span><span class="w"> </span><span class="kn">import</span> <span class="n">path</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">product</span><span class="w"> </span><span class="kn">import</span> <span class="n">views</span>

<span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;latest-products/&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">LatestProductsList</span><span class="o">.</span><span class="n">as_view</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;latest-products&#39;</span><span class="p">),</span>
    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;products/search/&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">search</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;product-search&#39;</span><span class="p">),</span>
    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;products/&lt;slug:category_slug&gt;/&lt;slug:product_slug&gt;/&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">ProductDetail</span><span class="o">.</span><span class="n">as_view</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;product-detail&#39;</span><span class="p">),</span>
    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;products/&lt;slug:category_slug&gt;/&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">CategoryDetail</span><span class="o">.</span><span class="n">as_view</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;category-detail&#39;</span><span class="p">),</span>
<span class="p">]</span>
</code></pre></div>

<hr />
<h2 id="tests_2">Tests<a class="headerlink" href="#tests_2" title="Permanent link">&para;</a></h2>
<p>Utilizo <code>APITestCase</code> de Django REST Framework para validar las principales funcionalidades de la API de productos, asegurando que las vistas respondan correctamente y que los datos devueltos sean los esperados.</p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">rest_framework.test</span><span class="w"> </span><span class="kn">import</span> <span class="n">APITestCase</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">rest_framework</span><span class="w"> </span><span class="kn">import</span> <span class="n">status</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">django.urls</span><span class="w"> </span><span class="kn">import</span> <span class="n">reverse</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">Category</span><span class="p">,</span> <span class="n">Product</span>

<span class="k">class</span><span class="w"> </span><span class="nc">ProductAPITest</span><span class="p">(</span><span class="n">APITestCase</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Crear una categoría y un producto para usar en los tests</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">category</span> <span class="o">=</span> <span class="n">Category</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Test Category&quot;</span><span class="p">,</span> <span class="n">slug</span><span class="o">=</span><span class="s2">&quot;test-category&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">product</span> <span class="o">=</span> <span class="n">Product</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
            <span class="n">category</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">category</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Test Product&quot;</span><span class="p">,</span>
            <span class="n">slug</span><span class="o">=</span><span class="s2">&quot;test-product&quot;</span><span class="p">,</span>
            <span class="n">price</span><span class="o">=</span><span class="mf">9.99</span><span class="p">,</span>
            <span class="n">weight</span><span class="o">=</span><span class="mi">100</span>
        <span class="p">)</span>
</code></pre></div>

<h3 id="test_latest_products_list">test_latest_products_list<a class="headerlink" href="#test_latest_products_list" title="Permanent link">&para;</a></h3>
<p>Este test verifica que la vista de productos más recientes (<code>latest-products</code>) responda con éxito (código 200) y que el producto creado en <code>setUp</code> aparezca en la lista.</p>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">test_latest_products_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">url</span> <span class="o">=</span> <span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;latest-products&#39;</span><span class="p">)</span>  
    <span class="c1"># Construcción dinámica de la URL usando el nombre de la ruta</span>
    <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;/api/v1/latest-products/&#39;</span><span class="p">)</span>  
    <span class="c1"># Se puede usar directamente la URL</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="n">status</span><span class="o">.</span><span class="n">HTTP_200_OK</span><span class="p">)</span> 
     <span class="c1"># Comprobamos respuesta exitosa</span>
    <span class="c1"># Confirmamos que &quot;Test Product&quot; esté en los datos recibidos</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">any</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Test Product&quot;</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">data</span><span class="p">))</span>
</code></pre></div>

<hr />
<h3 id="test_product_detail">test_product_detail<a class="headerlink" href="#test_product_detail" title="Permanent link">&para;</a></h3>
<p>Comprueba que la vista de detalle de producto funcione correctamente, devolviendo el producto esperado cuando se consulta por categoría y slug.</p>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">test_product_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/api/v1/products/</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">category</span><span class="o">.</span><span class="n">slug</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">product</span><span class="o">.</span><span class="n">slug</span><span class="si">}</span><span class="s1">/&#39;</span>
    <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="n">status</span><span class="o">.</span><span class="n">HTTP_200_OK</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span> <span class="s2">&quot;Test Product&quot;</span><span class="p">)</span>  
    <span class="c1"># Validamos que el producto sea el correcto</span>
</code></pre></div>

<hr />
<h3 id="test_category_detail">test_category_detail<a class="headerlink" href="#test_category_detail" title="Permanent link">&para;</a></h3>
<p>Valida que la vista de detalle de categoría responde correctamente e incluye la lista de productos asociados.</p>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">test_category_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/api/v1/products/</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">category</span><span class="o">.</span><span class="n">slug</span><span class="si">}</span><span class="s1">/&#39;</span>
    <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="n">status</span><span class="o">.</span><span class="n">HTTP_200_OK</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span> <span class="s2">&quot;Test Category&quot;</span><span class="p">)</span>  
    <span class="c1"># Confirmamos la categoría</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="s1">&#39;products&#39;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">data</span><span class="p">)</span> 
     <span class="c1"># Verificamos que se devuelvan los productos relacionados</span>
</code></pre></div>

<hr />
<h3 id="test_search_products">test_search_products<a class="headerlink" href="#test_search_products" title="Permanent link">&para;</a></h3>
<p>Test para la funcionalidad de búsqueda. Envía una consulta y verifica que el producto que contiene el término se incluya en la respuesta.</p>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">test_search_products</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;/api/v1/products/search/&#39;</span>
    <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;query&#39;</span><span class="p">:</span> <span class="s1">&#39;Test&#39;</span><span class="p">},</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;json&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="n">status</span><span class="o">.</span><span class="n">HTTP_200_OK</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">any</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Test Product&quot;</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">data</span><span class="p">))</span>
</code></pre></div>

<hr />
<h3 id="test_search_no_query">test_search_no_query<a class="headerlink" href="#test_search_no_query" title="Permanent link">&para;</a></h3>
<p>Asegura que si no se envía ningún término de búsqueda, la respuesta sea exitosa y se retorne una lista vacía.</p>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">test_search_no_query</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;/api/v1/products/search/&#39;</span>
    <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="p">{},</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;json&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="n">status</span><span class="o">.</span><span class="n">HTTP_200_OK</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;products&#39;</span><span class="p">],</span> <span class="p">[])</span>
</code></pre></div>

<h2 id="aplicacion-order">Aplicación Order<a class="headerlink" href="#aplicacion-order" title="Permanent link">&para;</a></h2>
<h2 id="modelo">Modelo<a class="headerlink" href="#modelo" title="Permanent link">&para;</a></h2>
<p>Representa una orden de compra realizada por un usuario en la tienda. Contiene información del cliente, detalles del pago y estado del envío.</p>
<h3 id="campos-principales">Campos principales:<a class="headerlink" href="#campos-principales" title="Permanent link">&para;</a></h3>
<ul>
<li><code>user</code>: Relación con el modelo <code>User</code> de Django. Indica el cliente que realizó el pedido.</li>
<li><code>first_name</code>, <code>last_name</code>, <code>email</code>, <code>address</code>, <code>zipcode</code>, <code>place</code>, <code>phone</code>: Datos personales y de contacto del comprador para la entrega.</li>
<li><code>created_at</code>: Fecha y hora en que se creó el pedido. Se asigna automáticamente.</li>
<li><code>paid_amount</code>: Monto total pagado por el pedido. Puede estar vacío si el pago no se ha procesado aún.</li>
<li><code>stripe_token</code>: Token asociado a Stripe para el pago, usado para validación y seguimiento del pago.</li>
<li><code>shipping_cost</code>: Costo del envío, que puede variar según el destino o método.</li>
<li><code>status</code>: Estado actual del pedido. Puede ser:<ul>
<li><code>"processing"</code> (En proceso)</li>
<li><code>"shipped"</code> (Enviado)</li>
<li><code>"delivered"</code> (Entregado)</li>
</ul>
</li>
<li><code>tracking_number</code>: Número de seguimiento para el envío, opcional y se asigna cuando está disponible.</li>
</ul>
<h3 id="comportamiento">Comportamiento:<a class="headerlink" href="#comportamiento" title="Permanent link">&para;</a></h3>
<ul>
<li>Los pedidos se ordenan por fecha de creación, mostrando primero las más recientes (<code>ordering = ['-created_at']</code>).</li>
<li>La representación en texto (<code>__str__</code>) devuelve el nombre del comprador, para identificación rápida en el admin o logs.</li>
</ul>
<hr />
<p><img alt="image.png" src="image.png" /></p>
<h2 id="modelo-orderitem">Modelo <code>OrderItem</code><a class="headerlink" href="#modelo-orderitem" title="Permanent link">&para;</a></h2>
<p>Representa un ítem individual dentro de un pedido, es decir, un producto comprado.</p>
<h3 id="campos-principales_1">Campos principales:<a class="headerlink" href="#campos-principales_1" title="Permanent link">&para;</a></h3>
<ul>
<li><code>order</code>: Relación con <code>Order</code>. Un ítem pertenece a un pedido específico.</li>
<li><code>product</code>: Relación con <code>Product</code>. El producto que fue comprado.</li>
<li><code>price</code>: Precio unitario del producto en el momento de la compra. Esto garantiza que cambios futuros en precios no afecten el histórico de órdenes.</li>
<li><code>quantity</code>: Cantidad comprada de ese producto.</li>
<li><code>selected_option</code>: Opcional, describe alguna variante o opción elegida para el producto (por ejemplo, talla, color).</li>
</ul>
<h3 id="comportamiento_1">Comportamiento:<a class="headerlink" href="#comportamiento_1" title="Permanent link">&para;</a></h3>
<ul>
<li>La representación en texto devuelve el <code>id</code> del ítem, para referencias sencillas.</li>
</ul>
<hr />
<p>Esta aplicación permite gestionar pedidos complejos, donde cada orden puede contener múltiples productos con opciones específicas. Se almacena información del cliente y del pago para facilitar la gestión y seguimiento, así como el estado de envío.</p>
<h2 id="vistas_1">Vistas<a class="headerlink" href="#vistas_1" title="Permanent link">&para;</a></h2>
<h3 id="checkout-funcion-vista"><code>checkout</code> (Función vista)<a class="headerlink" href="#checkout-funcion-vista" title="Permanent link">&para;</a></h3>
<p><strong>Descripción:</strong></p>
<p>Permite a un usuario autenticado realizar el pago y crear una nueva orden.</p>
<p><strong>Método:</strong></p>
<p><code>POST</code></p>
<p><strong>Autenticación y permisos:</strong></p>
<ul>
<li>Solo usuarios autenticados mediante token pueden acceder.</li>
</ul>
<p><strong>Flujo principal:</strong></p>
<ol>
<li>Recibe los datos de la orden desde el cliente.</li>
<li>Valida los datos con <code>OrderSerializer</code>.</li>
<li>Calcula el total a cobrar sumando el costo de los productos y el envío.</li>
<li>Realiza el cobro mediante la API de Stripe usando el token recibido.</li>
<li>Si el pago es exitoso, guarda la orden asociándola al usuario autenticado.</li>
<li>Devuelve la orden creada con estado HTTP 201.</li>
</ol>
<p><strong>Errores:</strong></p>
<ul>
<li>Si falla la validación o el cobro con Stripe, devuelve error 400 con detalles.</li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="nd">@api_view</span><span class="p">([</span><span class="s1">&#39;POST&#39;</span><span class="p">])</span>
<span class="nd">@authentication_classes</span><span class="p">([</span><span class="n">authentication</span><span class="o">.</span><span class="n">TokenAuthentication</span><span class="p">])</span>
<span class="nd">@permission_classes</span><span class="p">([</span><span class="n">permissions</span><span class="o">.</span><span class="n">IsAuthenticated</span><span class="p">])</span>
<span class="k">def</span><span class="w"> </span><span class="nf">checkout</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="n">serializer</span> <span class="o">=</span> <span class="n">OrderSerializer</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">serializer</span><span class="o">.</span><span class="n">is_valid</span><span class="p">():</span>
        <span class="n">stripe</span><span class="o">.</span><span class="n">api_key</span> <span class="o">=</span> <span class="n">settings</span><span class="o">.</span><span class="n">STRIPE_SECRET_KEY</span>

        <span class="n">items</span> <span class="o">=</span> <span class="n">serializer</span><span class="o">.</span><span class="n">validated_data</span><span class="p">[</span><span class="s1">&#39;items&#39;</span><span class="p">]</span>
        <span class="n">shipping_cost</span> <span class="o">=</span> <span class="n">serializer</span><span class="o">.</span><span class="n">validated_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;shipping_cost&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="n">paid_amount</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;quantity&#39;</span><span class="p">)</span> <span class="o">*</span> <span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;product&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">price</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">items</span><span class="p">)</span>
        <span class="n">total_to_charge</span> <span class="o">=</span> <span class="n">paid_amount</span> <span class="o">+</span> <span class="n">shipping_cost</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">charge</span> <span class="o">=</span> <span class="n">stripe</span><span class="o">.</span><span class="n">Charge</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
                <span class="n">amount</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">total_to_charge</span> <span class="o">*</span> <span class="mi">100</span><span class="p">),</span>
                <span class="n">currency</span><span class="o">=</span><span class="s1">&#39;EUR&#39;</span><span class="p">,</span>
                <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Charge from Charge from TangerineMessStore&#39;</span><span class="p">,</span>
                <span class="n">source</span><span class="o">=</span><span class="n">serializer</span><span class="o">.</span><span class="n">validated_data</span><span class="p">[</span><span class="s1">&#39;stripe_token&#39;</span><span class="p">]</span>
            <span class="p">)</span>

            <span class="n">serializer</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">user</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="p">,</span> <span class="n">paid_amount</span><span class="o">=</span><span class="n">total_to_charge</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">Response</span><span class="p">(</span><span class="n">serializer</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">status</span><span class="o">=</span><span class="n">status</span><span class="o">.</span><span class="n">HTTP_201_CREATED</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Response</span><span class="p">(</span><span class="n">serializer</span><span class="o">.</span><span class="n">errors</span><span class="p">,</span> <span class="n">status</span><span class="o">=</span><span class="n">status</span><span class="o">.</span><span class="n">HTTP_400_BAD_REQUEST</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">Response</span><span class="p">(</span><span class="n">serializer</span><span class="o">.</span><span class="n">errors</span><span class="p">,</span> <span class="n">status</span><span class="o">=</span><span class="n">status</span><span class="o">.</span><span class="n">HTTP_400_BAD_REQUEST</span><span class="p">)</span>
</code></pre></div>

<hr />
<h3 id="orderslist-clase-basada-en-vista-apiview"><code>OrdersList</code> (Clase basada en vista - APIView)<a class="headerlink" href="#orderslist-clase-basada-en-vista-apiview" title="Permanent link">&para;</a></h3>
<p><strong>Descripción:</strong></p>
<p>Lista todas las órdenes realizadas por el usuario autenticado.</p>
<p><strong>Método:</strong></p>
<p><code>GET</code></p>
<p><strong>Autenticación y permisos:</strong></p>
<ul>
<li>Solo usuarios autenticados mediante token pueden acceder.</li>
</ul>
<p><strong>Flujo principal:</strong></p>
<ol>
<li>Filtra las órdenes por el usuario autenticado.</li>
<li>Serializa la lista con <code>MyOrderSerializer</code>.</li>
<li>Devuelve la lista de órdenes en formato JSON.</li>
</ol>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">OrdersList</span><span class="p">(</span><span class="n">APIView</span><span class="p">):</span>
    <span class="n">authentication_classes</span> <span class="o">=</span> <span class="p">[</span><span class="n">authentication</span><span class="o">.</span><span class="n">TokenAuthentication</span><span class="p">]</span>
    <span class="n">permission_classes</span> <span class="o">=</span> <span class="p">[</span><span class="n">permissions</span><span class="o">.</span><span class="n">IsAuthenticated</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">orders</span> <span class="o">=</span> <span class="n">Order</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">user</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="p">)</span>
        <span class="n">serializer</span> <span class="o">=</span> <span class="n">MyOrderSerializer</span><span class="p">(</span><span class="n">orders</span><span class="p">,</span> <span class="n">many</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Response</span><span class="p">(</span><span class="n">serializer</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
</code></pre></div>

<ul>
<li>Se usa Stripe para procesar pagos, configurando la clave secreta desde la configuración del proyecto.</li>
<li>La lógica de cobro es manejada dentro de la vista <code>checkout</code>, asegurando que solo se cree la orden tras confirmarse el pago.</li>
<li>El uso de autenticación por token garantiza seguridad y control de acceso a las órdenes y pagos.</li>
</ul>
<p><img alt="image.png" src="image%201.png" /></p>
<h2 id="tests_3">Tests<a class="headerlink" href="#tests_3" title="Permanent link">&para;</a></h2>
<p>Estos tests comprueban el correcto funcionamiento de los endpoints relacionados con la creación de pedidos (checkout) y la consulta de pedidos existentes para un usuario autenticado.</p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">rest_framework.test</span><span class="w"> </span><span class="kn">import</span> <span class="n">APITestCase</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">rest_framework</span><span class="w"> </span><span class="kn">import</span> <span class="n">status</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">django.contrib.auth.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">User</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">rest_framework.authtoken.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">Token</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">django.urls</span><span class="w"> </span><span class="kn">import</span> <span class="n">reverse</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">Order</span><span class="p">,</span> <span class="n">OrderItem</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">product.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">Product</span><span class="p">,</span> <span class="n">Category</span>
</code></pre></div>

<h3 id="setup-inicial">Setup inicial<a class="headerlink" href="#setup-inicial" title="Permanent link">&para;</a></h3>
<p>Se crea un usuario de prueba con token de autenticación, así como una categoría y producto para simular la compra.</p>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">user</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create_user</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s1">&#39;testuser&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;testpass&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">token</span> <span class="o">=</span> <span class="n">Token</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">user</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">user</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">credentials</span><span class="p">(</span><span class="n">HTTP_AUTHORIZATION</span><span class="o">=</span><span class="s1">&#39;Token &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">token</span><span class="o">.</span><span class="n">key</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">category</span> <span class="o">=</span> <span class="n">Category</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Test Category&quot;</span><span class="p">,</span> <span class="n">slug</span><span class="o">=</span><span class="s2">&quot;test-category&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">product</span> <span class="o">=</span> <span class="n">Product</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
        <span class="n">category</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">category</span><span class="p">,</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Test Product&quot;</span><span class="p">,</span>
        <span class="n">slug</span><span class="o">=</span><span class="s2">&quot;test-product&quot;</span><span class="p">,</span>
        <span class="n">price</span><span class="o">=</span><span class="mf">10.00</span><span class="p">,</span>
        <span class="n">weight</span><span class="o">=</span><span class="mi">100</span>
    <span class="p">)</span>
</code></pre></div>

<hr />
<h3 id="test-exito-en-checkout">Test: Éxito en checkout<a class="headerlink" href="#test-exito-en-checkout" title="Permanent link">&para;</a></h3>
<p>Este test envía una solicitud POST válida a la ruta de checkout para crear un pedido. Se valida que:</p>
<ul>
<li>La respuesta sea HTTP 201 (creado).</li>
<li>Se haya creado un pedido y un ítem relacionado.</li>
<li>El monto pagado sea el correcto (precio productos + envío).</li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">test_checkout_success</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">url</span> <span class="o">=</span> <span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;checkout&#39;</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;first_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Sergio&quot;</span><span class="p">,</span>
        <span class="s2">&quot;last_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Delgado&quot;</span><span class="p">,</span>
        <span class="s2">&quot;email&quot;</span><span class="p">:</span> <span class="s2">&quot;matraca@example.com&quot;</span><span class="p">,</span>
        <span class="s2">&quot;address&quot;</span><span class="p">:</span> <span class="s2">&quot;123 Matracazo&quot;</span><span class="p">,</span>
        <span class="s2">&quot;zipcode&quot;</span><span class="p">:</span> <span class="s2">&quot;12345&quot;</span><span class="p">,</span>
        <span class="s2">&quot;place&quot;</span><span class="p">:</span> <span class="s2">&quot;City&quot;</span><span class="p">,</span>
        <span class="s2">&quot;phone&quot;</span><span class="p">:</span> <span class="s2">&quot;1234567890&quot;</span><span class="p">,</span>
        <span class="s2">&quot;stripe_token&quot;</span><span class="p">:</span> <span class="s2">&quot;tok_visa&quot;</span><span class="p">,</span>
        <span class="s2">&quot;shipping_cost&quot;</span><span class="p">:</span> <span class="s2">&quot;5.00&quot;</span><span class="p">,</span>
        <span class="s2">&quot;items&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="s2">&quot;product&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">product</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
                <span class="s2">&quot;quantity&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
                <span class="s2">&quot;price&quot;</span><span class="p">:</span> <span class="s2">&quot;10.00&quot;</span>
            <span class="p">}</span>
        <span class="p">]</span>
    <span class="p">}</span>
    <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;json&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="n">status</span><span class="o">.</span><span class="n">HTTP_201_CREATED</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Order</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">count</span><span class="p">(),</span> <span class="mi">1</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">OrderItem</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">count</span><span class="p">(),</span> <span class="mi">1</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Order</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">first</span><span class="p">()</span><span class="o">.</span><span class="n">paid_amount</span><span class="p">,</span> <span class="mf">25.00</span><span class="p">)</span>  <span class="c1"># (2*10) + 5 envío</span>
</code></pre></div>

<hr />
<h3 id="test-checkout-con-campos-faltantes">Test: Checkout con campos faltantes<a class="headerlink" href="#test-checkout-con-campos-faltantes" title="Permanent link">&para;</a></h3>
<p>Verifica que la API rechace solicitudes incompletas o inválidas, devolviendo un error HTTP 400.</p>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">test_checkout_missing_fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">url</span> <span class="o">=</span> <span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;checkout&#39;</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;first_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Sergio&quot;</span><span class="p">,</span>
        <span class="s2">&quot;stripe_token&quot;</span><span class="p">:</span> <span class="s2">&quot;tok_visa&quot;</span><span class="p">,</span>
        <span class="s2">&quot;items&quot;</span><span class="p">:</span> <span class="p">[]</span>
    <span class="p">}</span>
    <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;json&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="n">status</span><span class="o">.</span><span class="n">HTTP_400_BAD_REQUEST</span><span class="p">)</span>
</code></pre></div>

<hr />
<h3 id="test-listado-de-pedidos-del-usuario">Test: Listado de pedidos del usuario<a class="headerlink" href="#test-listado-de-pedidos-del-usuario" title="Permanent link">&para;</a></h3>
<p>Simula la consulta GET para obtener los pedidos creados por el usuario autenticado. Verifica que la respuesta sea correcta y que se devuelva la cantidad adecuada de pedidos.</p>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">test_orders_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">order</span> <span class="o">=</span> <span class="n">Order</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
        <span class="n">user</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">user</span><span class="p">,</span>
        <span class="n">first_name</span><span class="o">=</span><span class="s2">&quot;Sergio&quot;</span><span class="p">,</span>
        <span class="n">last_name</span><span class="o">=</span><span class="s2">&quot;Doe&quot;</span><span class="p">,</span>
        <span class="n">email</span><span class="o">=</span><span class="s2">&quot;matraca@example.com&quot;</span><span class="p">,</span>
        <span class="n">address</span><span class="o">=</span><span class="s2">&quot;123 Matracazo&quot;</span><span class="p">,</span>
        <span class="n">zipcode</span><span class="o">=</span><span class="s2">&quot;12345&quot;</span><span class="p">,</span>
        <span class="n">place</span><span class="o">=</span><span class="s2">&quot;City&quot;</span><span class="p">,</span>
        <span class="n">phone</span><span class="o">=</span><span class="s2">&quot;1234567890&quot;</span><span class="p">,</span>
        <span class="n">stripe_token</span><span class="o">=</span><span class="s2">&quot;tok_visa&quot;</span><span class="p">,</span>
        <span class="n">paid_amount</span><span class="o">=</span><span class="mf">15.00</span>
    <span class="p">)</span>
    <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;orders-list&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="n">status</span><span class="o">.</span><span class="n">HTTP_200_OK</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">data</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div>

<h2 id="urls_2">Urls<a class="headerlink" href="#urls_2" title="Permanent link">&para;</a></h2>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">django.urls</span><span class="w"> </span><span class="kn">import</span> <span class="n">path</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.</span><span class="w"> </span><span class="kn">import</span> <span class="n">views</span>

<span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;checkout/&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">checkout</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;checkout&#39;</span><span class="p">),</span>
    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;orders/&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">OrdersList</span><span class="o">.</span><span class="n">as_view</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;orders-list&#39;</span><span class="p">),</span>
<span class="p">]</span>
</code></pre></div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs", "navigation.top", "navigation.sections", "navigation.instant", "toc.integrate", "content.code.copy", "content.code.annotate", "header.autohide", "search.highlight", "search.suggest"], "search": "../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
    
  </body>
</html>